<form [formGroup]="destinationForm" (ngSubmit)="onSubmit()" class="p-4">
  <mat-tab-group [(selectedIndex)]="selectedTabIndex">

    <!-- Destination Info -->
    <mat-tab label="Info">
      <div formGroupName="destination">
        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Title</mat-label>
          <input matInput formControlName="title" required />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Image URL</mat-label>
          <input matInput formControlName="image_url" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Best Time to Visit</mat-label>
          <input matInput formControlName="best_time_to_visit" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Weather</mat-label>
          <input matInput formControlName="weather" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Currency</mat-label>
          <input matInput formControlName="currency" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Language</mat-label>
          <input matInput formControlName="language" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Time Zone</mat-label>
          <input matInput formControlName="time_zone" />
        </mat-form-field>

        <mat-form-field appearance="fill" class="w-full">
          <mat-label>Description</mat-label>
          <textarea matInput formControlName="description" rows="4"></textarea>
        </mat-form-field>
      </div>
    </mat-tab>

    <!-- Locations -->
    <mat-tab label="Locations">
      <div formArrayName="locations">
        <div *ngFor="let loc of getArrayControl('locations').controls; let i = index" [formGroupName]="i" class="mb-4">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Name</mat-label>
            <input matInput formControlName="name" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Description</mat-label>
            <input matInput formControlName="description" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Image URL</mat-label>
            <input matInput formControlName="image_url" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Iframe 360 URL</mat-label>
            <input matInput formControlName="iframe_360" />
          </mat-form-field>

          <button mat-raised-button color="warn" (click)="removeItem('locations', i)">Remove</button>
          <hr class="my-2" />
        </div>
        <button mat-raised-button color="primary" (click)="addItem('locations', { name: '', description: '', image_url: '', iframe_360: '' })">+ Add Location</button>
      </div>
    </mat-tab>

    <!-- Attractions -->
    <mat-tab label="Attractions">
      <div formArrayName="attractions">
        <div *ngFor="let attr of getArrayControl('attractions').controls; let i = index" [formGroupName]="i" class="mb-4">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Image URL</mat-label>
            <input matInput formControlName="image_url" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Rating</mat-label>
            <input type="number" matInput formControlName="rating" min="0" max="5" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Video URL</mat-label>
            <input matInput formControlName="video_url" />
          </mat-form-field>

          <button mat-raised-button color="warn" (click)="removeItem('attractions', i)">Remove</button>
          <hr class="my-2" />
        </div>
        <button mat-raised-button color="primary" (click)="addItem('attractions', { title: '', image_url: '', rating: 0, video_url: '' })">+ Add Attraction</button>
      </div>
    </mat-tab>

    <!-- Ethnicities -->
    <mat-tab label="Ethnicities">
      <div formArrayName="ethnicities">
        <div *ngFor="let eth of getArrayControl('ethnicities').controls; let i = index" [formGroupName]="i" class="mb-4">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Image URL</mat-label>
            <input matInput formControlName="image_url" />
          </mat-form-field>

          <button mat-raised-button color="warn" (click)="removeItem('ethnicities', i)">Remove</button>
          <hr class="my-2" />
        </div>
        <button mat-raised-button color="primary" (click)="addItem('ethnicities', { title: '', image_url: '' })">+ Add Ethnicity</button>
      </div>
    </mat-tab>

    <!-- Cuisines -->
    <mat-tab label="Cuisines">
      <div formArrayName="cuisines">
        <div *ngFor="let cuisine of getArrayControl('cuisines').controls; let i = index" [formGroupName]="i" class="mb-4">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Image URL</mat-label>
            <input matInput formControlName="image_url" />
          </mat-form-field>

          <button mat-raised-button color="warn" (click)="removeItem('cuisines', i)">Remove</button>
          <hr class="my-2" />
        </div>
        <button mat-raised-button color="primary" (click)="addItem('cuisines', { title: '', image_url: '' })">+ Add Cuisine</button>
      </div>
    </mat-tab>

    <!-- Activities -->
    <mat-tab label="Activities">
      <div formArrayName="activities">
        <div *ngFor="let act of getArrayControl('activities').controls; let i = index" [formGroupName]="i" class="mb-4">
          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" />
          </mat-form-field>

          <mat-form-field appearance="fill" class="w-full">
            <mat-label>Image URL</mat-label>
            <input matInput formControlName="image_url" />
          </mat-form-field>

          <button mat-raised-button color="warn" (click)="removeItem('activities', i)">Remove</button>
          <hr class="my-2" />
        </div>
        <button mat-raised-button color="primary" (click)="addItem('activities', { title: '', image_url: '' })">+ Add Activity</button>
      </div>
    </mat-tab>
  </mat-tab-group>

  <div class="mt-6 text-right">
    <button mat-stroked-button color="accent" type="button" (click)="selectedTabIndex = 0">Back to Info</button>
    <button mat-raised-button color="primary" type="submit">Save Destination</button>
  </div>
</form>
